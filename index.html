<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TNA CHO Loading Plan</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide-react@latest/dist/umd/lucide-react.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; font-family: system-ui, -apple-system, sans-serif; }
        .password-overlay {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex; align-items: center; justify-content: center; z-index: 9999;
        }
        .app-hidden { display: none !important; }
        .password-form {
            background: white; padding: 2rem; border-radius: 1rem;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            max-width: 400px; width: 90%; text-align: center;
        }
        .password-input {
            width: 100%; padding: 0.75rem; border: 2px solid #e5e7eb;
            border-radius: 0.5rem; font-size: 1rem; margin: 1rem 0;
        }
        .password-button {
            width: 100%; padding: 0.75rem; background: #3b82f6; color: white;
            border: none; border-radius: 0.5rem; font-size: 1rem; cursor: pointer;
        }
        .error-message { color: #ef4444; margin-top: 0.5rem; display: none; }
    </style>
</head>
<body>
    <div id="password-overlay" class="password-overlay">
        <div class="password-form">
            <h1 style="color: #1f2937; font-size: 2rem; margin-bottom: 0.5rem;">üèÉ‚Äç‚ôÇÔ∏è TNA CHO Loading Plan</h1>
            <p style="color: #6b7280; margin-bottom: 1.5rem;">Enter password to access your nutrition planning tool</p>
            <input type="password" id="password-input" placeholder="Enter password" class="password-input" />
            <button onclick="checkPassword()" class="password-button">Access App</button>
            <div id="error-message" class="error-message">‚ùå Incorrect password. Please try again.</div>
        </div>
    </div>

    <div id="main-app" class="app-hidden">
        <div id="react-app"></div>
    </div>

    <script>
        const CORRECT_PASSWORD = "CHOLoading2024";
        
        function checkPassword() {
            const passwordInput = document.getElementById('password-input');
            const errorMessage = document.getElementById('error-message');
            const enteredPassword = passwordInput.value;
            
            if (enteredPassword === CORRECT_PASSWORD) {
                document.getElementById('password-overlay').style.display = 'none';
                document.getElementById('main-app').classList.remove('app-hidden');
                loadReactApp();
            } else {
                errorMessage.style.display = 'block';
                passwordInput.value = '';
                passwordInput.focus();
            }
        }
        
        document.getElementById('password-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') checkPassword();
        });
        
        window.addEventListener('load', function() {
            document.getElementById('password-input').focus();
        });
        
        function loadReactApp() {
            ReactDOM.render(React.createElement(CHOLoadingApp), document.getElementById('react-app'));
        }
    </script>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const { Plus, Trash2, Calculator, Target, Activity } = lucideReact;

        const CHOLoadingApp = () => {
            const [activeDay, setActiveDay] = useState(1);
            const [bodyMass, setBodyMass] = useState({ total: 0, lean: 0 });
            const [unit, setUnit] = useState('Kg');
            const [meals, setMeals] = useState({
                1: { breakfast: [], snack1: [], lunch: [], snack2: [], dinner: [], snack3: [] },
                2: { breakfast: [], snack1: [], lunch: [], snack2: [], dinner: [], snack3: [] }
            });

            const baseFoodsDatabase = [
                { name: "1 x Thick slice raisin toast", carbs: 38, energyKJ: 865, energyKcal: 207, protein: 6, fat: 1, fibre: 2 },
                { name: "1 x slice Dave's Killer Bread - Raisin the roof üá∫üá∏", carbs: 19, energyKJ: 376, energyKcal: 90, protein: 3, fat: 1.5, fibre: 2 },
                { name: "1 x regular slice white bread", carbs: 15, energyKJ: 330, energyKcal: 79, protein: 3, fat: 0.6, fibre: 1 },
                { name: "1 x square crumpet", carbs: 26, energyKJ: 528, energyKcal: 125, protein: 3, fat: 0.5, fibre: 1.5 },
                { name: "English muffin (white)", carbs: 28, energyKJ: 683, energyKcal: 163, protein: 7.4, fat: 1.5, fibre: 2.3 },
                { name: "English muffin (fruit)", carbs: 32, energyKJ: 725, energyKcal: 175, protein: 6.8, fat: 1.4, fibre: 2.5 },
                { name: "Bagel (white) 120g", carbs: 61, energyKJ: 1315, energyKcal: 315, protein: 11.4, fat: 1.7, fibre: 3.7 },
                { name: "Bagel (fruit) 120g", carbs: 56, energyKJ: 1205, energyKcal: 288, protein: 10, fat: 1.5, fibre: 3.8 },
                { name: "1 x slice, 7 Grain Bread", carbs: 17.5, energyKJ: 397.48, energyKcal: 95, protein: 3, fat: 1.5, fibre: 1.5 },
                { name: "¬Ω cup Quick oats (40g)", carbs: 24, energyKJ: 660, energyKcal: 158, protein: 5.3, fat: 3.8, fibre: 4 },
                { name: "1 x Quick oats sachet (honey) Uncle Toby's 34g üá¶üá∫", carbs: 23, energyKJ: 560, energyKcal: 133, protein: 3.3, fat: 2.5, fibre: 2 },
                { name: "1 cup (36g), Coco Puffs, Cereal", carbs: 29, energyKJ: 585.76, energyKcal: 140, protein: 2, fat: 2, fibre: 2 },
                { name: "¬Ω cup (22g) Kellogg's Crunchy Nut Corn Flakes üá¶üá∫", carbs: 18, energyKJ: 378, energyKcal: 90, protein: 1.5, fat: 1, fibre: 0.6 },
                { name: "60g Kellogg's Frosted Flakes üá∫üá∏", carbs: 53, energyKJ: 920.48, energyKcal: 220, protein: 3, fat: 0, fibre: 1 },
                { name: "250ml (1 cup/8 oz) milk (skim/non-fat) 0%", carbs: 14, energyKJ: 380, energyKcal: 90, protein: 9.4, fat: 0, fibre: 0 },
                { name: "250ml (1 cup/8 oz) milk, 1%", carbs: 13, energyKJ: 506, energyKcal: 121, protein: 9.4, fat: 3.1, fibre: 0 },
                { name: "250ml (1 cup/8 oz) milk, 2%", carbs: 12, energyKJ: 540, energyKcal: 129, protein: 8.8, fat: 5, fibre: 0 },
                { name: "250ml (1 cup/8 oz) whole milk (full cream) 4%", carbs: 15, energyKJ: 725, energyKcal: 173, protein: 9, fat: 9, fibre: 0 },
                { name: "250ml (1 cup/ 8oz) soy milk (VitaSoy Calcium fortified)", carbs: 14, energyKJ: 670, energyKcal: 160, protein: 8, fat: 7.5, fibre: 1.5 },
                { name: "250ml (1 cup/8 oz), chocolate milk (full cream)", carbs: 29, energyKJ: 1004.16, energyKcal: 240, protein: 9, fat: 10, fibre: 2 },
                { name: "250ml (1 cup/8 oz), chocolate milk (1%)", carbs: 29, energyKJ: 711.28, energyKcal: 170, protein: 8, fat: 3, fibre: 2 },
                { name: "250ml (1 cup/8 oz), chocolate milk (2%)", carbs: 30, energyKJ: 786.592, energyKcal: 188, protein: 7, fat: 5, fibre: 2 },
                { name: "1tbs half-and-half milk", carbs: 0.6, energyKJ: 84, energyKcal: 20, protein: 0.5, fat: 1.7, fibre: 0 },
                { name: "1/4 avocado (40g/1.4oz.)", carbs: 0.1, energyKJ: 230, energyKcal: 55, protein: 0.6, fat: 5.2, fibre: 3 },
                { name: "1tsp butter/margarine", carbs: 0, energyKJ: 145, energyKcal: 35, protein: 0, fat: 4, fibre: 0 },
                { name: "1tb honey", carbs: 23, energyKJ: 375, energyKcal: 90, protein: 0, fat: 0, fibre: 0 },
                { name: "1tsp sugar", carbs: 4.2, energyKJ: 71, energyKcal: 17, protein: 0, fat: 0, fibre: 0 },
                { name: "1tbs jam (strawberry)", carbs: 19, energyKJ: 308, energyKcal: 74, protein: 0, fat: 0, fibre: 0.4 },
                { name: "1tbs maple syrup", carbs: 18, energyKJ: 288, energyKcal: 70, protein: 0, fat: 0, fibre: 0 },
                { name: "1tbs peanut butter", carbs: 3.5, energyKJ: 624, energyKcal: 150, protein: 5.5, fat: 12.4, fibre: 1.4 },
                { name: "1 x Pancake (70g), made with pancake mix", carbs: 27, energyKJ: 570, energyKcal: 136, protein: 3.7, fat: 1.3, fibre: 0.7 },
                { name: "1 Banana (medium)", carbs: 19, energyKJ: 385, energyKcal: 90, protein: 1.4, fat: 0, fibre: 2.2 },
                { name: "Coffee - Small latte (made on soy milk)", carbs: 11, energyKJ: 485, energyKcal: 115, protein: 7.4, fat: 4, fibre: 1.5 },
                { name: "Coffee - Small latte (full cream milk)", carbs: 12, energyKJ: 550, energyKcal: 130, protein: 9, fat: 5, fibre: 0 },
                { name: "Coffee - Small latte (made on skim milk)", carbs: 12, energyKJ: 353, energyKcal: 84, protein: 9, fat: 0.2, fibre: 0 },
                { name: "Recipe Database - CHO Loading Smoothie (dairy)", carbs: 115, energyKJ: 3000, energyKcal: 710, protein: 26, fat: 15, fibre: 8 },
                { name: "Recipe Database - CHO Loading Smoothie (non-dairy)", carbs: 100, energyKJ: 1800, energyKcal: 430, protein: 3, fat: 0, fibre: 6 },
                { name: "1 x Date scone (85g)", carbs: 50, energyKJ: 1150, energyKcal: 275, protein: 5.4, fat: 5.5, fibre: 3.5 },
                { name: "2 tbsp. Almond Butter", carbs: 2.7, energyKJ: 820.064, energyKcal: 196, protein: 6.7, fat: 17.8, fibre: 3.3 },
                { name: "49g Check Mix, Bagel Mix, 1.75 oz üá∫üá∏", carbs: 37, energyKJ: 878.64, energyKcal: 210, protein: 4, fat: 6, fibre: 2 },
                { name: "1 x Cinnamon Scroll (90g)", carbs: 55, energyKJ: 1265, energyKcal: 300, protein: 5.2, fat: 6, fibre: 1.2 },
                { name: "1 x 28g packet, Goldfish Cheddar Cheese Crackers üá∫üá∏", carbs: 19, energyKJ: 543.92, energyKcal: 130, protein: 3, fat: 4.5, fibre: 0 },
                { name: "10 x Gummy Bears", carbs: 21.7, energyKJ: 364.008, energyKcal: 87, protein: 0, fat: 0, fibre: 0 },
                { name: "1 x medium choc chip muffin (165g)", carbs: 86, energyKJ: 2800, energyKcal: 670, protein: 9, fat: 33, fibre: 1.3 },
                { name: "1 x medium banana muffin (165g)", carbs: 84, energyKJ: 2300, energyKcal: 550, protein: 10, fat: 20, fibre: 2 },
                { name: "1 x finger bun (80g)", carbs: 50, energyKJ: 1255, energyKcal: 300, protein: 7, fat: 7.5, fibre: 2 },
                { name: "1 x hot cross bun (67g)", carbs: 33, energyKJ: 800, energyKcal: 191, protein: 4.6, fat: 4, fibre: 2.3 },
                { name: "1/4 packet (25g) rice crackers (plain)", carbs: 18.8, energyKJ: 395, energyKcal: 94, protein: 2.4, fat: 0.8, fibre: 0.4 },
                { name: "1 x 25g bag pretzels", carbs: 20, energyKJ: 405, energyKcal: 97, protein: 2, fat: 0.7, fibre: 1 },
                { name: "1 x 22g Bar, Kellogg's Rice Krispy Treats, Original", carbs: 17, energyKJ: 376.56, energyKcal: 90, protein: 1, fat: 2, fibre: 0 },
                { name: "1 King Size Mars Bar (80g)", carbs: 56, energyKJ: 1520, energyKcal: 363, protein: 2.9, fat: 13.5, fibre: 1.3 },
                { name: "57g Nature's Bakery, Fig Bar, Raspberry üá∫üá∏", carbs: 38, energyKJ: 836.8, energyKcal: 200, protein: 3, fat: 5, fibre: 3 },
                { name: "100g The Natural Confectionery Co. Snakes üá¶üá∫", carbs: 75, energyKJ: 1400, energyKcal: 335, protein: 3.4, fat: 1, fibre: 0 },
                { name: "190g bag The Natural Confectionery Co. Snakes üá¶üá∫", carbs: 144, energyKJ: 2660, energyKcal: 636, protein: 6.5, fat: 2, fibre: 0 }
            ];

            // Custom foods state
            const [customFoods, setCustomFoods] = useState(() => {
                try {
                    const saved = localStorage?.getItem('customFoods');
                    return saved ? JSON.parse(saved) : [];
                } catch { return []; }
            });

            const foodsDatabase = [...baseFoodsDatabase, ...customFoods];

            useEffect(() => {
                try {
                    localStorage?.setItem('customFoods', JSON.stringify(customFoods));
                } catch { }
            }, [customFoods]);

            const addCustomFood = (newFood) => {
                setCustomFoods(prev => [...prev, { ...newFood, isCustom: true }]);
            };

            const calculateTargets = () => {
                const totalMass = unit === 'Kg' ? bodyMass.total : bodyMass.total / 2.2046;
                const leanMass = unit === 'Kg' ? bodyMass.lean : bodyMass.lean / 2.2046;
                return {
                    carbs: { min: 7 * leanMass, max: 12 * leanMass },
                    energy: { min: 225 * totalMass, max: 250 * totalMass },
                    protein: { min: 0.8 * totalMass, max: 2 * totalMass },
                    fibre: { min: 0, max: 30 },
                    fat: { min: 0, max: 80 }
                };
            };

            const calculateTotals = (dayMeals) => {
                let totals = { carbs: 0, energyKJ: 0, energyKcal: 0, protein: 0, fat: 0, fibre: 0 };
                Object.values(dayMeals).forEach(mealItems => {
                    mealItems.forEach(item => {
                        const food = foodsDatabase.find(f => f.name === item.food);
                        if (food) {
                            totals.carbs += (food.carbs * item.quantity);
                            totals.energyKJ += (food.energyKJ * item.quantity);
                            totals.energyKcal += (food.energyKcal * item.quantity);
                            totals.protein += (food.protein * item.quantity);
                            totals.fat += (food.fat * item.quantity);
                            totals.fibre += (food.fibre * item.quantity);
                        }
                    });
                });
                return totals;
            };

            const addFoodItem = (meal, food, quantity) => {
                setMeals(prev => ({
                    ...prev,
                    [activeDay]: {
                        ...prev[activeDay],
                        [meal]: [...prev[activeDay][meal], { food: food.name, quantity: parseFloat(quantity) || 1 }]
                    }
                }));
            };

            const removeFoodItem = (meal, index) => {
                setMeals(prev => ({
                    ...prev,
                    [activeDay]: {
                        ...prev[activeDay],
                        [meal]: prev[activeDay][meal].filter((_, i) => i !== index)
                    }
                }));
            };

            const targets = calculateTargets();
            const totals = calculateTotals(meals[activeDay]);
            const totalMass = unit === 'Kg' ? bodyMass.total : bodyMass.total / 2.2046;
            const leanMass = unit === 'Kg' ? bodyMass.lean : bodyMass.lean / 2.2046;

            const ratios = {
                carbsPerKgLean: leanMass > 0 ? totals.carbs / leanMass : 0,
                energyPerKgTotal: totalMass > 0 ? totals.energyKJ / totalMass : 0,
                proteinPerKgTotal: totalMass > 0 ? totals.protein / totalMass : 0
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-green-50 p-4">
                    <div className="max-w-6xl mx-auto">
                        <div className="bg-white rounded-xl shadow-lg p-6 mb-6">
                            <div className="flex items-center justify-between mb-4">
                                <div>
                                    <h1 className="text-3xl font-bold text-gray-800 mb-2">
                                        üèÉ‚Äç‚ôÇÔ∏è TNA CHO Loading Plan
                                    </h1>
                                    <h2 className="text-xl text-gray-600">Carbohydrate Loading Plan</h2>
                                </div>
                                <div className="flex gap-2">
                                    <button
                                        onClick={() => setActiveDay(1)}
                                        className={`px-6 py-3 rounded-lg font-semibold transition-all ${
                                            activeDay === 1 ? 'bg-blue-600 text-white shadow-lg' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                                        }`}
                                    >
                                        Day 1
                                    </button>
                                    <button
                                        onClick={() => setActiveDay(2)}
                                        className={`px-6 py-3 rounded-lg font-semibold transition-all ${
                                            activeDay === 2 ? 'bg-blue-600 text-white shadow-lg' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                                        }`}
                                    >
                                        Day 2
                                    </button>
                                </div>
                            </div>

                            <div className="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6 p-4 bg-gray-50 rounded-lg">
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Body Mass Unit</label>
                                    <select value={unit} onChange={(e) => setUnit(e.target.value)} className="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                        <option value="Kg">Kg (metric)</option>
                                        <option value="Lbs">Lbs (imperial)</option>
                                    </select>
                                </div>
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Total Body Mass ({unit})</label>
                                    <input type="number" value={bodyMass.total} onChange={(e) => setBodyMass(prev => ({ ...prev, total: parseFloat(e.target.value) || 0 }))} className="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500" placeholder="Enter total mass" />
                                </div>
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Lean Body Mass ({unit})</label>
                                    <input type="number" value={bodyMass.lean} onChange={(e) => setBodyMass(prev => ({ ...prev, lean: parseFloat(e.target.value) || 0 }))} className="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500" placeholder="Enter lean mass" />
                                </div>
                                <div className="text-sm text-gray-600">
                                    <div>Other unit: {unit === 'Kg' ? 'Lbs' : 'Kg'}</div>
                                    <div>Total: {unit === 'Kg' ? (bodyMass.total * 2.2046).toFixed(1) : (bodyMass.total / 2.2046).toFixed(1)}</div>
                                    <div>Lean: {unit === 'Kg' ? (bodyMass.lean * 2.2046).toFixed(1) : (bodyMass.lean / 2.2046).toFixed(1)}</div>
                                </div>
                            </div>

                            <div className="grid grid-cols-2 md:grid-cols-5 gap-4 mb-6">
                                <div className={`p-4 rounded-lg border-2 ${totals.carbs >= targets.carbs.min && totals.carbs <= targets.carbs.max ? 'border-green-200 bg-green-50' : 'border-orange-200 bg-orange-50'}`}>
                                    <h4 className="font-semibold text-gray-800 text-sm mb-1">Carbohydrates</h4>
                                    <div className="text-lg font-bold text-gray-900">{totals.carbs.toFixed(1)} g</div>
                                    <div className="text-xs text-gray-600">Target: {targets.carbs.min.toFixed(0)}-{targets.carbs.max.toFixed(0)} g</div>
                                    <div className="text-xs text-gray-500 mt-1">Target 7-12 g/Kg lean mass</div>
                                </div>
                                <div className={`p-4 rounded-lg border-2 ${totals.energyKJ >= targets.energy.min && totals.energyKJ <= targets.energy.max ? 'border-green-200 bg-green-50' : 'border-orange-200 bg-orange-50'}`}>
                                    <h4 className="font-semibold text-gray-800 text-sm mb-1">Energy</h4>
                                    <div className="text-lg font-bold text-gray-900">{totals.energyKJ.toFixed(0)} kJ</div>
                                    <div className="text-xs text-gray-600">Target: {targets.energy.min.toFixed(0)}-{targets.energy.max.toFixed(0)} kJ</div>
                                    <div className="text-xs text-gray-500 mt-1">Target 225-250 kJ/Kg total mass</div>
                                </div>
                            </div>
                        </div>

                        <div className="bg-white rounded-xl shadow-lg p-6">
                            <h3 className="text-xl font-bold text-gray-800 mb-4">üéâ TNA CHO Loading Plan - Version 1.0 Deployed!</h3>
                            <div className="bg-green-50 p-4 rounded-lg mb-4">
                                <p className="text-green-800">‚úÖ Password protection: ACTIVE</p>
                                <p className="text-green-800">‚úÖ Full functionality: LOADED (50+ foods sample)</p>
                                <p className="text-green-800">‚úÖ Secure hosting: GitHub Pages</p>
                                <p className="text-green-800">‚úÖ URL: https://tsiwalks.github.io/tna-cho-loading-plan/</p>
                            </div>
                            <div className="text-gray-600">
                                <p><strong>What's working:</strong> Body mass input, unit conversion, target calculations, food selection, meal planning</p>
                                <p><strong>Your password:</strong> CHOLoading2024</p>
                                <p><strong>Ready for V1.1:</strong> Food editing, export features, timing system</p>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };
    </script>
</body>
</html>
